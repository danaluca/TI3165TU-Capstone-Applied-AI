# TI3165TU Capstone AI
**AI Minor Project Group 8, TI3165TU Capstone, Research on Prediction of Extreme Events Derived from Latent Space Compression of 2D Kolmogorov Flows**

Extreme events are sudden yet fatal state changes present in turbulent flows, namely cyclones, flash floods, and rogue waves. By implementing AI methods, lacking physical knowledge can be replaced with predictive models of incoming extreme events and their associated time window. A Variational Autoencoder was used to generate latent spaces of the Kolmogorov flows at Re=40.0, fed into a modularity maximization clustering technique that could categorize portions of the time-series into normal, precursor, or extreme states. 

# Authors
Thibault Clara, Faculty of Aerospace Engineering, TU Delft

Ali Alper Ataşoğlu, Faculty of Aerospace Engineering, TU Delft

Miłosz Pluciński, Faculty of Aerospace Engineering, TU Delft

Björn Kleipool, Faculty of Aerospace Engineering, TU Delft

Daniela Luca, Faculty of Aerospace Engineering, TU Delft

Jacob Schut, Faculty of Applied Physics, TU Delft

# Supported by
Dr. Anh Khoa Doan, Assistant Professor, TU Delft / Faculty of Aerospace Engineering, FPT/Aerodynamics section & AI Fluids Lab

# Data
For this project, our own data was generated using functions/models in the folder `VAE` and compressed to an `.h5` file. The data has dimensionality (2400, 48, 48, 2), which means 2400 48x48 images were generated. Please note that our own generated flows through KOLSOL are not saved in this folder/repository because they are too large. Therefore, the relevant properties have been compressed into .h5 files. The generated images were then transformed to a 32-dimensional latent space using the variational autoencoder. Additionally, this latent space was concatenated with the kinetic energy "k" and the energy dissipation rate "D" for each image, to be used for clustering.

# File Hierarchy
* `FlowCompression` [Folder]: Functions created by 22/23 group, to be used as reference for specific implementations
* `MasterCode` [Folder]: Use of modularity maximization clustering technique, as implemented by Aerodynamics Master student Urszula Gołyska, which contains an array of visualization tools for identification of normal, precursor, and extreme states.
* `VAE` [Folder]
  * `SampleFlows` [Folder]: Contains generated flow sets from 22/23 group. *Please note that our own generated flows are not saved in this folder/repository because they are too large. Therefore, the relevant properties have been compressed into .h5 files.*
  * `Cluster visualisation.py` [File]: Generates a visualisation of the clustered latent space, given a latent space trajectory and corresponding cluster indices.
  * `Decoder test.py` [File]: Demonstrates the decoding process of the VAE Class, by generating a smoothed Brownian trajectory in the latent space and decoding that trajectory into a flow field.
  * `Encoder test.py` [File]: Demonstrates the decoding process of the VAE by loading the training flow field and encoding it into a latent space trajectory.
  * `VAE performance.txt` [File]: A text file containing all the model checkpoints of the VAE, including major architecture changes. The major version of the checkpoints indicate incompatible architecture changes, while the minor version indicates cross-compatible model weights changes.
  * `VAEClass.py` [File]: Describes the main architecture of the VAE, including the default training loop.
  * `vae_decoder_ph_v1.3.h5` [File]: Version 1.3 of the VAE decoder network (specs found in VAE performance.txt).
  * `vae_decoder_ph_v5.0.h5` [File]: Version 5.0 of the VAE decoder network (specs found in VAE performance.txt).
  * `vae_encoder_ph_v1.3.h5` [File]: Version 1.3 of the VAE encoder network (specs found in VAE performance.txt).
  * `vae_encoder_ph_v5.0.h5` [File]: Version 5.0 of the VAE encoder network (specs found in VAE performance.txt).
  * `vae_latent_space.npy` [File]: The latent space trajectory used in Cluster visualisation.py
  * `vae_ph_v1.3.h5` [File]: Version 1.3 of the VAE network (specs found in VAE performance.txt).
  * `vae_ph_v5.0.h5` [File]: Version 5.0 of the VAE network (specs found in VAE performance.txt). Latest, the most up-to-date model of the autoencoder.
* `__pycache__` [Folder]
* `main` [Folder]
  * `Dissip.npy` [File]: Dissipation rate of the flow field
  * `cluster_stat.csv` [File]: Dataframe generated by the clustering algorithm
  * `data_remover.py` [File]: Data remover that removes unnecessary data from a .h5 file
  * `main.ipynb` [File]: Main Notebook of the whole project 2023-2024
  * `stat_circ_time.pdf` [File]: Plot generated from the clustering algorithm
  * `stat_nr_instances.pdf` [File]: Plot generated from the clustering algorithm
  * `stat_nr_nodes.pdf` [File]: Plot generated from the clustering algorithm
  * `stat_path.pdf` [File]: Plot generated from the clustering algorithm
  * `stat_percent_time.pdf` [File]: Plot generated from the clustering algorithm
  * `stat_prob.pdf` [File]: Plot generated from the clustering algorithm
  * `stat_time.pdf` [File]: Plot generated from the clustering algorithm
  * `t.npy` [File]: time stamps of the flow field
  * `u_refined.npy` [File]: Velocity in the x direction of the flow field
  * `v_refined.npy` [File]: Velocity in the y direction of the flow field
  * `vae_latent_space_new_24_1.npy` [File]: Encoded the flow field to 32 latent spaces
  * `vort_refined.npy` [File]: Vorticity of the flow field
* `.gitattributes` [File]
* `AE highres test.py` [File]: VAE model verification, reconstruction error cross-validation against original flow field for high-dimensional mesh
* `helper.py` [File]: Reads data, calculation of kinetic energy and energy dissipation rate for a given velocity field, and animated contour plots of energy fields
* `requirements.txt` [File]: Used packages
* `var_autoencoder_ph_v1.h5` [File]: VAE Model Weights
* `var_decoder_ph_v1.h5` [File]: VAE Model Weights, Decoder-side
* `var_encoder_ph_v1.h5` [File]: VAE Model Weights, Encoder-side

# Used Packages
See `requirements.txt`

# Used Github Repositories
## 22/23 Capstone Project - Latent Space Compression of Kolmogorov Flows (Basis of 23/24 Research)
https://github.com/POTN1K/CompressionFlowAE 

## Kolmogorov Flow Generation - KolSol
https://github.com/MagriLab/KolSol

## Aerodynamics Master Code by Urszula Gołyska
https://github.com/UlaCebula/MSc_Code 

## Clustering Algorithm: Modularity Maximization
https://github.com/thelahunginjeet/python-modularity-maximization
